fix(historico): corrigir modal detalhe-dia e rastro por estado via /machine/status

- Corrige funcoes faltantes (buildSegmentsForHour/stateToCss/getStatusTsMs) que causavam 'Falha ao carregar detalhe do dia'
- Rastro por segmentos usa timestamp do status (quando disponivel) em vez de Date.now()
- Mantem horas futuras sempre cinza
