fix(producao_hora): persistir hora (inclusive zero) e fechar última hora ao sair do turno

- atualizar_producao_hora: ao sair do turno (idx=None), fecha e faz upsert da última hora
- garante persistência do '0' ao abrir hora (não depende de produzir)
