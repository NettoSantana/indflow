fix(historico): corrigir indentacao e limpar codigo morto em _calc_seg_metrics

- Remove bloco antigo sobrando apos return em _calc_seg_metrics (causava erro no Pylance)
- Mantem regra acumulativa por segments (RUN/STOP) e paradas (RUN->STOP)
- Mantem persistencia RUN/STOP em machine_state_event (opcao 1)
