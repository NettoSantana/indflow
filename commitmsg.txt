feat: extrai persistencia de producao horaria para producao_horaria_repo

- cria repo com upsert e leitura de producao por hora no SQLite
- prepara reducao do machine_calc sem mudar comportamento
