fix(historico): fallback RUN/STOP quando nao ha machine_state_event no dia

- Se run_intervals estiver vazio: usa produzido>0 para marcar RUN na hora; senao STOP
- Evita tempo_parado_sec=3600 em horas com producao quando nao ha rastro no banco
