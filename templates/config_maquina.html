<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>Configuração da Máquina</title>

  <style>
    body{
      font-family: Arial, sans-serif;
      background:#f3f4f6;
      margin:0;
      padding:20px;
    }
    h1{
      color:#0f172a;
      margin-bottom:20px;
    }
    .card{
      background:#fff;
      padding:20px;
      border-radius:10px;
      box-shadow:0 2px 8px rgba(0,0,0,0.1);
      max-width:900px;
      margin:auto;
    }
    .row{
      display:flex;
      gap:20px;
      margin-bottom:15px;
    }
    .row input, .row select{
      padding:8px;
      width:100%;
      border:1px solid #cbd5e1;
      border-radius:6px;
    }
    .subtitle{
      font-weight:bold;
      margin-top:25px;
      margin-bottom:10px;
      color:#1e293b;
    }
    table{
      width:100%;
      border-collapse:collapse;
      margin-top:10px;
    }
    table th, table td{
      border:1px solid #cbd5e1;
      padding:8px;
      text-align:center;
    }
    table th{
      background:#e2e8f0;
    }
  </style>

</head>
<body>

<div class="card">

  <h1>Configuração – MAQUINA 01</h1>

  <!-- META E RAMPA -->
  <div class="subtitle">Meta e Rampa</div>

  <div class="row">
    <div style="flex:1">
      <label>Meta Total do Turno</label>
      <input type="number" id="meta" value="1000" min="1">
    </div>

    <div style="flex:1">
      <label>Rampa Inicial (%)</label>
      <input type="number" id="rampa" value="50" min="0" max="100">
    </div>
  </div>

  <!-- CONFIGURAÇÃO DO TURNO -->
  <div class="subtitle">Turno 1</div>

  <div class="row">
    <div style="flex:1">
      <label>Início</label>
      <input type="time" id="t1_ini" value="06:00">
    </div>

    <div style="flex:1">
      <label>Fim</label>
      <input type="time" id="t1_fim" value="16:00">
    </div>
  </div>

  <button onclick="gerarTabela()" style="padding:10px 18px;background:#0f172a;color:#fff;border:none;border-radius:6px;cursor:pointer;">
    Gerar Meta Distribuída
  </button>

  <div class="subtitle">Tabela Gerada</div>
  <div id="tabela_turno1"></div>

</div>

<script>

function rangeHoras(ini, fim){

  const hIni = parseInt(ini.split(":")[0]);
  const hFim = parseInt(fim.split(":")[0]);

  const horas = [];

  for(let h = hIni; h < hFim; h++){
    horas.push({
      ini: h.toString().padStart(2,"0"),
      fim: (h+1).toString().padStart(2,"0")
    });
  }

  return horas;
}


function gerarTabela(){
  const meta   = parseInt(document.getElementById("meta").value);
  const rampa  = parseInt(document.getElementById("rampa").value);
  const ini    = document.getElementById("t1_ini").value;
  const fim    = document.getElementById("t1_fim").value;

  const turno = { ini, fim };

  calculaTabela(turno, meta, rampa, "tabela_turno1");
}



function calculaTabela(turno, meta, rampa, idTabela){

  if(!turno.ini || !turno.fim || meta <= 0){
    document.getElementById(idTabela).innerHTML = "";
    return;
  }

  const horas = rangeHoras(turno.ini, turno.fim);

  if(horas.length === 0){
    document.getElementById(idTabela).innerHTML = "";
    return;
  }

  // ------------------------------------------
  // NOVA REGRA INDUSTRIAL — Rampa por hora
  // ------------------------------------------

  const horasTotais = horas.length;

  // meta por hora normal
  const metaHora = meta / horasTotais;

  // primeira hora com rampa
  const primeiraHora = Math.floor(metaHora * (rampa/100));

  // restante de peças após a rampa
  const restante = meta - primeiraHora;

  // distribuição entre as demais horas
  const metaHoraBase = Math.floor(restante / (horasTotais - 1));

  let tabela = `
    <table>
      <tr>
        <th>Hora</th>
        <th>Meta</th>
      </tr>
      <tr>
        <td>${horas[0].ini}:00 - ${horas[0].fim}:00</td>
        <td>${primeiraHora}</td>
      </tr>
  `;

  let acumulado = primeiraHora;

  for(let i = 1; i < horasTotais; i++){

    let val = metaHoraBase;

    // última hora recebe o resto final
    if(i === horasTotais - 1){
      val = meta - acumulado;
    }

    acumulado += val;

    tabela += `
      <tr>
        <td>${horas[i].ini}:00 - ${horas[i].fim}:00</td>
        <td>${val}</td>
      </tr>
    `;
  }

  tabela += `</table>`;

  document.getElementById(idTabela).innerHTML = tabela;
}

</script>

</body>
</html>
